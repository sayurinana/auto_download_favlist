## 🔍 待定项U001 - BBDown serve 工作目录策略

### ✅ 方案S001 - 【已采纳 +60分】
**📍 原文位置**：（ai-agent-memory/now-task.md，第5-6行）
> 添加一项全局配置，调用BBDown时的工作目录，当需要启动BBDown时，默认以此路径为其工作路径

**🎯 优化方案（执行）**：
> 在 `GlobalDefaults` 与 `FavConfig` 中新增 `bbdown_work_dir` 字段（可全局设置并按配置覆盖）。运行 `bbdown` 与 `bbdown serve` 时传入该目录，如处于 WSL 环境同时兼容 Windows 路径；录入/编辑界面及全局默认菜单均可维护该字段。

**⚖️ 权衡分析**：
- ✅ **优势**（+45分）：统一 BBDown 运行目录，避免跨终端路径混乱。
- ✅ **优势**（+20分）：支持默认 + 覆盖，适配多收藏夹场景。
- ❌ **风险**（-5分）：Windows/WSL 路径差异需谨慎（已提供双路径配置）。

---

## 🔍 待定项U002 - 下载任务并发限制

### ✅ 方案S001 - 【已采纳 +80分】
**📍 原文位置**：（ai-agent-memory/now-task.md，第7-10行）
> 控制查漏补缺时下载任务的并发数量…仅在当前运行中的任务数量小于限制的数量时才添加任务

**🎯 优化方案（执行）**：
> 定义 `bbdown_max_concurrency`（全局默认 + 每项配置可覆盖）。补缺流程提交任务时先查询 `/get-tasks/running`，若达到上限则等待，按批提交并在 `wait_until_idle` 中跟踪目标 BV 直至全部完成后再提交下一批。

**⚖️ 权衡分析**：
- ✅ **优势**（+60分）：限制并发，防止队列暴涨、资源紧张。
- ✅ **优势**（+25分）：结合 finished 列表确保准确退出。
- ❌ **风险**（-5分）：API 缺少 Aid/Url 时需 fallback（已以 BV lower-case 匹配处理）。
