## 🔍 待定项U001 - BBDown serve 工作目录策略

### ✅ 方案S001 - 【建议采纳 +60分】
**📍 原文位置**：（ai-agent-memory/now-task.md，第5-6行）
> 添加一项全局配置，调用BBDown时的工作目录，当需要启动BBDown时，默认以此路径为其工作路径

**🎯 优化方案**：
> 在 `GlobalDefaults` 中新增 `bbdown_work_dir` 字段，并允许每个 FavConfig 覆盖；`run_bbdown` 与 `start_bbdown_serve` 在构建命令时指定 `current_dir`（WSL 下对应挂载路径、Windows 下使用原始路径），并在菜单输入中提示该默认值。

**⚖️ 权衡分析**：
- ✅ **优势**（+45分）：统一与 override 的工作路径，避免跨终端调用时写入混乱。
- ✅ **优势**（+20分）：用户无需每次手工输入路径。
- ❌ **风险**（-5分）：路径需兼容 Windows/WSL 差异，可能需双路径映射。

---

## 🔍 待定项U002 - 下载任务并发限制

### ✅ 方案S001 - 【建议采纳 +80分】
**📍 原文位置**：（ai-agent-memory/now-task.md，第7-10行）
> 控制查漏补缺时下载任务的并发数量…仅在当前运行中的任务数量小于限制数量时才添加任务

**🎯 优化方案**：
> 新增全局配置 `bbdown_max_concurrency`（每配置可覆盖），在补缺流程中分批提交任务：调用 `/get-tasks/running` 获取当前数量，若达到上限则轮询等待；提交时仅向队列推入允许数量；同时在 `wait_until_idle` 使用目标列表确保所有任务完成。

**⚖️ 权衡分析**：
- ✅ **优势**（+60分）：防止 BBDown 队列过载，便于控制资源。
- ✅ **优势**（+25分）：可扩展为动态调整策略。
- ❌ **风险**（-5分）：若 API 返回的 running 列表不含任务，需容错处理。

---