## 任务前置准备

### 前置准备概述

**任务前置准备**是对now-task.md进行的分析优化工作，目的是理解任务内容和目的，结合项目的全面分析进行优化确认，生成清晰完整的执行方案。

### 前置准备流程

#### 1. 任务分析阶段

1. **全面分析now-task.md内容**
   - 理解任务的核心目标和具体要求
   - 识别任务的复杂度和涉及范围
   - 分析任务与项目现有结构的关系

2. **项目环境分析** 
   - 根据任务复杂度审阅相关内容
   - 分析项目结构、现有规范、相关文档
   - 默认优先查阅`ai-agent-memory/`下除`criterion-*`之外的指引；当需要详细规范或多方案比较时，再检索对应的`criterion-*`守则
   - 研究类似任务的处理方式和经验

3. **复杂度评估**
   - 判断是否需要使用Sequential-Thinking进行结构化分析
   - 识别任务中的多层含义、多个子目标或复杂业务逻辑

#### 2. 任务内容优化阶段

1. **准确性优化**
   - 检查任务描述的准确性和完整性
   - 识别歧义和不明确之处
   - 明确任务边界和成功标准

2. **简洁性优化** 
   - 识别和处理冗余表述
   - 区分真实冗余与必要的重复强调
   - 确保表达简洁但不失准确性

3. **可执行性优化**
   - 将抽象要求转化为具体可执行的步骤
   - 确保每个步骤都有明确的输入、输出和验证标准
   - 考虑执行顺序和依赖关系
    - 按`undetermined-template.md`列出所有优化或替代方案，写入`undetermined.md`并标注优势/风险。
    - 在未获得用户统一确认前，禁止进入下一环节或修改`optimized-task.md`。

#### 3. 待定项处理机制

**重要说明**：任务内容优化阶段中分析得到的所有优化可能项，必须按以下流程处理然后经过用户处理确认再继续后续的环节：

1. **记录待定项**：参考@undetermined-template.md格式，将待定项写入`ai-agent-output/YYYY-MM-DDTHH-MM-SS_UTC+8_任务简述/undetermined.md`
2. **统一确认**：完整分析后统一向用户确认所有待定项
3. **结果整理**：用户确认后删除不采纳的待定项，多方案待定项仅保留采纳方案
4. **方案唯一性**：确保每个保留待定项只有唯一实施方案
5. **结果整合**：将确认结果整合到`optimized-task.md`

#### 4. 优化结果生成

1. **生成optimized-task.md**
   - 包含优化后的完整任务描述
   - 明确的执行步骤和验证标准
   - 整合用户确认的待定项结果
   - 文档应存放在`ai-agent-output/YYYY-MM-DDTHH-MM-SS_UTC+8_任务简述/optimized-task.md`，与同批次的`undetermined.md`、`AI-AGENT_working-status.csv`归档在一起

2. **质量验证**
   - 确保优化后的任务描述清晰、准确、可执行
   - 验证任务目标与原始需求的一致性
   - 确认所有关键决策点都已明确
   - 标注文档更新阶段需执行的`CHANGELOG.md`条目维护与版本号更新策略，确保后续环节可直接落实

### 异常处理和质量保证

1. **用户沟通处理**
   - 用户不配合删除待定项时再次澄清确认
   - 遇到模糊需求时主动询问，不做假设

2. **质量检查标准**
   - 任务描述准确性检查
   - 执行步骤完整性检查  
   - 成功标准明确性检查

3. **回滚和重分析机制**
   - 保持预处理过程的可回滚性
   - 必要时重新进行分析和优化
   - 记录重要决策的原因和过程

